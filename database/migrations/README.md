# üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö CS2 Match Prediction System

## üìã **–û–±–∑–æ—Ä**

–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –º–∞—Ç—á–µ–π CS2 —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º ChatGPT. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Å —Å–æ–±–ª—é–¥–µ–Ω–∏–µ–º –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ (3NF) –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –≤—ã—Å–æ–∫–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

## üèóÔ∏è **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**

### ‚úÖ **–ü—Ä–∏–Ω—Ü–∏–ø—ã –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**
- **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è**: –°–æ–±–ª—é–¥–µ–Ω–∏–µ 3-–π –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Ñ–æ—Ä–º—ã
- **ACID**: –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç–∏
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –∏ –∑–∞–ø—Ä–æ—Å—ã
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ä–æ—Å—Ç—É –¥–∞–Ω–Ω—ã—Ö
- **–¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å**: –°—Ç—Ä–æ–≥–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏

### üìä **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö**

#### üîó **–û—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏**
- **13 —Ç–∞–±–ª–∏—Ü** —Å —á–µ—Ç–∫–æ–π –∏–µ—Ä–∞—Ä—Ö–∏–µ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- **30+ –∏–Ω–¥–µ–∫—Å–æ–≤** –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- **JSONB –ø–æ–ª—è** –¥–ª—è –≥–∏–±–∫–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö

#### üìà **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–∞—Ä—Å–µ—Ä–∞ HLTV**
–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º–∞ —Å –¥–∞–Ω–Ω—ã–º–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–±–∏—Ä–∞–µ—Ç –≤–∞—à HLTV –ø–∞—Ä—Å–µ—Ä:

**–ö–æ–º–∞–Ω–¥—ã:**
- ‚úÖ HLTV ID, –Ω–∞–∑–≤–∞–Ω–∏–µ, —Ç–µ–≥, —Å—Ç—Ä–∞–Ω–∞
- ‚úÖ –†–µ–π—Ç–∏–Ω–≥, –æ—á–∫–∏, –ª–æ–≥–æ—Ç–∏–ø
- ‚úÖ –°—Å—ã–ª–∫–∞ –Ω–∞ HLTV –ø—Ä–æ—Ñ–∏–ª—å

**–ò–≥—Ä–æ–∫–∏:**
- ‚úÖ HLTV ID, –Ω–∏–∫, –Ω–∞—Å—Ç–æ—è—â–µ–µ –∏–º—è
- ‚úÖ –í–æ–∑—Ä–∞—Å—Ç, —Å—Ç—Ä–∞–Ω–∞, –∞–≤–∞—Ç–∞—Ä
- ‚úÖ –†–æ–ª—å –≤ –∫–æ–º–∞–Ω–¥–µ, –∏—Å—Ç–æ—Ä–∏—è –ø–µ—Ä–µ—Ö–æ–¥–æ–≤

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä–æ–∫–æ–≤:**
- ‚úÖ Rating 2.0, K/D ratio, ADR, KAST
- ‚úÖ –ü—Ä–æ—Ü–µ–Ω—Ç —Ö–µ–¥—à–æ—Ç–æ–≤, –∫–∞—Ä—Ç—ã —Å—ã–≥—Ä–∞–Ω—ã
- ‚úÖ –£–±–∏–π—Å—Ç–≤–∞/–∞—Å—Å–∏—Å—Ç—ã/—Å–º–µ—Ä—Ç–∏ –∑–∞ —Ä–∞—É–Ω–¥
- ‚úÖ –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

## üöÄ **–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç**

### 1Ô∏è‚É£ **–ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–π**
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏
php bin/migrate.php up

# –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
php bin/migrate.php up --target=20250625061216
```

### 2Ô∏è‚É£ **–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏**
```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü
\dt

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö
SELECT COUNT(*) FROM teams;
SELECT COUNT(*) FROM players;
SELECT COUNT(*) FROM matches;
```

## üìä **–î–∏–∞–≥—Ä–∞–º–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**

–ü–æ–ª–Ω–∞—è ERD –¥–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏:

![Database Schema](DATABASE_SCHEMA.md)

## üîç **–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**

### –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–ø-10 –∏–≥—Ä–æ–∫–æ–≤ –ø–æ —Ä–µ–π—Ç–∏–Ω–≥—É
```sql
SELECT 
    p.nickname,
    p.real_name,
    c.name as country,
    ps.rating_2_0,
    ps.maps_played
FROM players p
JOIN player_statistics ps ON p.id = ps.player_id
JOIN countries c ON p.country_id = c.id
WHERE ps.period_end = (SELECT MAX(period_end) FROM player_statistics)
ORDER BY ps.rating_2_0 DESC
LIMIT 10;
```

### –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ –º–∞—Ç—á–∏ —Å –ø—Ä–æ–≥–Ω–æ–∑–∞–º–∏
```sql
SELECT 
    m.scheduled_at,
    t1.name as team1,
    t2.name as team2,
    e.name as event,
    mp.predicted_winner_id,
    tw.name as predicted_winner,
    mp.confidence_percentage,
    mp.prediction_text
FROM matches m
JOIN teams t1 ON m.team1_id = t1.id
JOIN teams t2 ON m.team2_id = t2.id
JOIN events e ON m.event_id = e.id
LEFT JOIN match_predictions mp ON m.id = mp.match_id
LEFT JOIN teams tw ON mp.predicted_winner_id = tw.id
WHERE m.status = 'scheduled'
    AND m.scheduled_at > NOW()
ORDER BY m.scheduled_at;
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–æ—á–Ω–æ—Å—Ç–∏ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤
```sql
SELECT 
    COUNT(*) as total_predictions,
    COUNT(CASE WHEN is_correct = true THEN 1 END) as correct_predictions,
    ROUND(
        COUNT(CASE WHEN is_correct = true THEN 1 END)::decimal / 
        COUNT(CASE WHEN is_correct IS NOT NULL THEN 1 END) * 100, 2
    ) as accuracy_percentage,
    AVG(confidence_percentage) as avg_confidence
FROM match_predictions
WHERE is_correct IS NOT NULL;
```

## üìÅ **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤**

```
database/migrations/
‚îú‚îÄ‚îÄ üìÑ DATABASE_SCHEMA.md     # –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ üìÑ README.md              # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ üìÑ QUICKSTART.md          # –ö—Ä–∞—Ç–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
‚îú‚îÄ‚îÄ üìÑ env.example            # –ü—Ä–∏–º–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–∫
‚îú‚îÄ‚îÄ üìÑ composer.json          # PHP –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ üóÇÔ∏è bin/                   # –°–∫—Ä–∏–ø—Ç—ã –º–∏–≥—Ä–∞—Ü–∏–π
‚îî‚îÄ‚îÄ üóÇÔ∏è migrations/            # –§–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–π
    ‚îú‚îÄ‚îÄ postgres/             # PostgreSQL –º–∏–≥—Ä–∞—Ü–∏–∏
    ‚îÇ   ‚îú‚îÄ‚îÄ up/              # –ú–∏–≥—Ä–∞—Ü–∏–∏ "–≤–≤–µ—Ä—Ö"
    ‚îÇ   ‚îî‚îÄ‚îÄ down/            # –ú–∏–≥—Ä–∞—Ü–∏–∏ "–≤–Ω–∏–∑"
    ‚îî‚îÄ‚îÄ clickhouse/          # ClickHouse –º–∏–≥—Ä–∞—Ü–∏–∏
        ‚îú‚îÄ‚îÄ up/              # –ú–∏–≥—Ä–∞—Ü–∏–∏ "–≤–≤–µ—Ä—Ö"
        ‚îî‚îÄ‚îÄ down/            # –ú–∏–≥—Ä–∞—Ü–∏–∏ "–≤–Ω–∏–∑"
```

## üõ†Ô∏è **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º–∏**

### üêç **HLTV Parser (Python)**
```python
# –ü—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –ø–∞—Ä—Å–µ—Ä–æ–º
def save_team_data(team_data):
    query = """
    INSERT INTO teams (hltv_id, name, tag, country_id, world_ranking, points, hltv_url)
    VALUES (%(hltv_id)s, %(name)s, %(tag)s, %(country_id)s, %(ranking)s, %(points)s, %(url)s)
    ON CONFLICT (hltv_id) DO UPDATE SET
        name = EXCLUDED.name,
        world_ranking = EXCLUDED.world_ranking,
        points = EXCLUDED.points,
        updated_at = CURRENT_TIMESTAMP
    """
    cursor.execute(query, team_data)
```

### ü§ñ **Telegram Bot**
```python
# –ü—Ä–∏–º–µ—Ä –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –±–æ—Ç–∞
def get_upcoming_matches():
    query = """
    SELECT m.*, t1.name as team1, t2.name as team2, 
           mp.prediction_text, mp.confidence_percentage
    FROM matches m
    JOIN teams t1 ON m.team1_id = t1.id
    JOIN teams t2 ON m.team2_id = t2.id
    LEFT JOIN match_predictions mp ON m.id = mp.match_id
    WHERE m.status = 'scheduled' AND m.scheduled_at > NOW()
    ORDER BY m.scheduled_at
    LIMIT 5
    """
    return cursor.fetchall()
```

### üí∞ **Payment Service (PHP)**
```php
// –ü—Ä–∏–º–µ—Ä –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞—Ç–µ–∂–∞
function processPremiumPayment($userId, $amount) {
    $pdo->beginTransaction();
    try {
        // –°–æ–∑–¥–∞–µ–º –∑–∞–ø–∏—Å—å –æ –ø–ª–∞—Ç–µ–∂–µ
        $stmt = $pdo->prepare("
            INSERT INTO payments (user_id, amount, payment_type, status) 
            VALUES (?, ?, 'premium_subscription', 'completed')
        ");
        $stmt->execute([$userId, $amount]);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        $stmt = $pdo->prepare("
            UPDATE users 
            SET is_premium = true, premium_until = NOW() + INTERVAL '1 month'
            WHERE id = ?
        ");
        $stmt->execute([$userId]);
        
        $pdo->commit();
    } catch (Exception $e) {
        $pdo->rollback();
        throw $e;
    }
}
```

## üîß **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è**

### PostgreSQL –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
createdb cs2_prediction

# –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
createuser cs2_user

# –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∞–≤
GRANT ALL PRIVILEGES ON DATABASE cs2_prediction TO cs2_user;
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ
cp env.example .env

# –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=cs2_prediction
POSTGRES_USER=cs2_user
POSTGRES_PASSWORD=your_password
```

## üìà **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**

### –ü–æ–ª–µ–∑–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
```sql
-- –†–∞–∑–º–µ—Ä —Ç–∞–±–ª–∏—Ü
SELECT 
    schemaname,
    tablename,
    pg_size_pretty(pg_total_relation_size(tablename::text)) as size
FROM pg_tables 
WHERE schemaname = 'public'
ORDER BY pg_total_relation_size(tablename::text) DESC;

-- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏–Ω–¥–µ–∫—Å–æ–≤
SELECT 
    indexrelname,
    idx_tup_read,
    idx_tup_fetch
FROM pg_stat_user_indexes 
ORDER BY idx_tup_read DESC;

-- –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
SELECT query, calls, total_time, mean_time
FROM pg_stat_statements 
ORDER BY mean_time DESC 
LIMIT 10;
```

## üõ°Ô∏è **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (prepared statements)
- ‚úÖ –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ë–î
- ‚úÖ –†–µ–≥—É–ª—è—Ä–Ω–æ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ SSL —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞
pg_dump -h localhost -U cs2_user cs2_prediction > backup_$(date +%Y%m%d).sql

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞
psql -h localhost -U cs2_user cs2_prediction < backup_20241201.sql
```

## üìû **–ü–æ–¥–¥–µ—Ä–∂–∫–∞**

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ PostgreSQL**
2. **–£–±–µ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–î**
4. **–ò–∑—É—á–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤ `DATABASE_SCHEMA.md`**

---

**üéØ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** –í—ã –º–æ–∂–µ—Ç–µ –Ω–∞—á–∏–Ω–∞—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å –≤–∞—à–∏–º–∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º–∏. 